# Step 1: Simulate the Data
set.seed(0)
num_friends <- 20
true_heights <- runif(num_friends, 150, 200) # True heights in cm

# Measurement errors
error_edward <- rnorm(num_friends, 1, 2) 
error_hugo <- rnorm(num_friends, 0, 3)
error_lucy <- rnorm(num_friends, -1, 2)

heights_edward <- true_heights + error_edward
heights_hugo <- true_heights + error_hugo
heights_lucy <- true_heights + error_lucy

# Combine data into a dataframe
data <- data.frame(
  friend = rep(1:num_friends, 3),
  height = c(heights_edward, heights_hugo, heights_lucy),
  measurer = rep(c("Edward", "Hugo", "Lucy"), each=num_friends)
)

# Step 2: Conduct Three Tests

# Test 1: ANOVA
anova_result <- aov(height ~ measurer, data = data)
summary(anova_result)

# Test 2: Paired t-test between Edward and Hugo
t_test_result <- t.test(heights_edward, heights_hugo, paired = TRUE)
t_test_result

# Test 3: Regression analysis between Hugo and Lucy
reg_result <- lm(heights_lucy ~ heights_hugo)
summary(reg_result)
